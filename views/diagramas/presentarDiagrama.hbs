<div id="divPrincipal" class="divContenedorPrincipal">
    <div id="divPresentacionDiagrama" class="divDibujo">
        <img id="imgDiagrama" class="imgDibujo" usemap="#mapaDiagrama" onmousedown="down(event)" ondrop="drop(event)" ondragover="allowDrop(event)"/>
        <map id="mapaDiagrama" name="mapaDiagrama"></map>
        <canvas id="canvasDiagrama" width="1000" height="2000"></canvas>
    </div>
    <div id="divCapturaElemento" class="divEmergente">
        <div id="divBtnAccionElemento" class="divSubformulario">
            <button id="btnAgregarElemento" class="w3-button w3-round btnControl">Agregar elemento</button>
            <button id="btnEditarElemento" class="w3-button w3-round btnAdvertir">Editar elemento</button>
            <button id="btnEliminarElemento" class="w3-button w3-round btnDesistir">Eliminar elemento</button>
        </div>
        <div id="divBtnCapturaElemento" class="divSubformulario">
            <b><label id="lblTipoElemento" class="lblGuiaCaptura">Tipo de elemento</label></b><br><br>
            <button id="btnCapturaObjeto" class="w3-button w3-round btnControl">Agregar objeto</button>
            <button id="btnCapturaRelacion" class="w3-button w3-round btnControl">Agregar vínculo</button>
            <button id="btnEditarObjeto" class="w3-button w3-round btnAdvertir">Editar objeto</button>
            <button id="btnEditarRelacion" class="w3-button w3-round btnAdvertir">Editar vínculo</button>
            <button id="btnEliminarObjeto" class="w3-button w3-round btnDesistir">Eliminar objeto</button>
            <button id="btnEliminarRelacion" class="w3-button w3-round btnDesistir">Eliminar vínculo</button>
        </div>
        <div id="divBtnCapturaObjeto" class="divSubformulario">
            <b><label id="lblTipoObjeto" class="lblGuiaCaptura">Tipo de objeto</label></b><br><br>
        </div>
        <div id="divBtnCapturaRelacion" class="divSubformulario">
            <b><label id="lblTipoObjeto" class="lblGuiaCaptura">Tipo de vínculo</label></b><br><br>
        </div>
        <div id="divFormularioObjeto" class="divFormulario">
            <form id="formGrabarObjetoDiagramaSesion" method="POST" action="/main/grabarObjetoDiagramaSesion">
                <input id="inpIndiceObjetoSeleccionado" name="indiceObjetoSeleccionado" type="hidden" >
                <input id="inpIdObjetoSeleccionado" name="idObjetoSeleccionado" type="hidden" >
                <input id="inpIdTipoDiagrama" name="idTipoDiagrama" type="hidden" value="{{sesion.diagrama.tipoDiagrama.id}}">
                <input id="inpIdTipoObjeto" name="idTipoObjeto" type="hidden">
                <input id="inpNombreUsuarioObjeto" name="nombreUsuarioObjeto" type="hidden" value="{{nombreUsuario}}">
                <input id="inpIdDiagrama" name="idDiagrama" type="hidden" value="{{sesion.diagrama.id}}">
                <input id="inpIdSesionObjeto" name="idSesionObjeto" type="hidden" value="{{sesion.id}}">
                <div id="divPropiedadesObjeto" class="divSubformulario">
                    <b><label id="lblObjetoTipo" class="lblGuiaCaptura">Objeto</label></b><br><br>
                    <b><label id="lblPropiedadesObjeto" class="lblGuiaCaptura">Propiedades</label></b><br><br>
                </div>
                <div id="divCoordenadasObjeto" class="divSubformulario">
                    <b><label class="lblCaptura">Coordenadas:</label></b>
                    <br>
                    <table class="tblEncabezado">
                        <tr>
                            <td>
                                <label class="lblCaptura" style="alignment: center">x</label>
                                <input id="inpXObjeto" class="w3-input w3-round" name="xObjeto" type="number" min="0" step="10" >
                            </td>
                            <td>
                                <label class="lblCaptura" style="alignment: center">y</label>
                                <input id="inpYObjeto" class="w3-input w3-round" name="yObjeto" type="number" min="0" step="10" >
                            </td>
                        </tr>
                    </table>
                    <br>
                </div>
                <div id="divGrabacionObjeto" class="divSubformulario">
                    <button id="btnGrabarObjeto" class="w3-button w3-round btnControl" type="submit" onclick="inclusionElemento()">Grabar objeto</button>
                </div>
            </form>
        </div>
        <div id="divFormularioRelacion" class="divFormulario">
            <form id="formGrabarRelacionDiagramaSesion" method="POST" action="/main/grabarRelacionDiagramaSesion">
                <input id="inpIndiceRelacionSeleccionada" name="indiceRelacionSeleccionada" type="hidden" >
                <input id="inpIdRelacionSeleccionada" name="idRelacionSeleccionada" type="hidden" >
                <input id="inpIdTipoDiagramaRelacion" name="idTipoDiagramaRelacion" type="hidden" value="{{sesion.diagrama.tipoDiagrama.id}}">
                <input id="inpIdTipoRelacion" name="idTipoRelacion" type="hidden" >
                <input id="inpNombreUsuarioRelacion" name="nombreUsuarioRelacion" type="hidden" value="{{nombreUsuario}}">
                <input id="inpIdDiagramaRelacion" name="idDiagramaRelacion" type="hidden" value="{{sesion.diagrama.id}}">
                <input id="inpIdSesionRelacion" name="idSesionRelacion" type="hidden" value="{{sesion.id}}">
                <input id="inpIndiceObjetoInicial" name="indiceObjetoInicial" type="hidden" >
                <input id="inpIdObjetoInicial" name="idObjetoInicial" type="hidden" >
                <input id="inpNumeroPuertoObjetoInicial" name="numeroPuertoObjetoInicial" type="hidden" value="">
                <input id="inpIndiceObjetoFinal" name="indiceObjetoFinal" type="hidden" >
                <input id="inpIdObjetoFinal" name="idObjetoFinal" type="hidden" >
                <input id="inpNumeroPuertoObjetoFinal" name="numeroPuertoObjetoFinal" type="hidden" value="">
                <div id="divCapturarObjetoInicial" class="divSubformulario">
                    <b><label id="lblRelacionTipo" class="lblGuiaCaptura">Vínculo</label></b><br><br>
                    <b><label class="lblCaptura">Objeto inicial:</label></b>
                    <input id="inpNombreObjetoInicial" class="w3-input w3-round" name="nombreObjetoInicial" type="text" disabled>
                </div>
                <div id="divCapturarObjetoFinal" class="divSubformulario">
                    <b><label class="lblCaptura">Objeto final:</label></b>
                    <input id="inpNombreObjetoFinal" class="w3-input w3-round" name="nombreObjetoFinal" type="text" disabled>
                </div>
                <div id="divPropiedadesRelacion" class="divSubformulario">
                    <b><label id="lblPropiedadesRelacion" class="lblGuiaCaptura">Propiedades</label></b><br><br>
                </div>
                <div id="divGrabacionRelacion" class="divSubformulario">
                    <button id="btnGrabarRelacion" class="w3-button w3-round btnControl" type="submit" onclick="inclusionElemento()" style="display: inline-block">Grabar vínculo</button>
                </div>
            </form>
        </div>
        <div id="divFormularioMovimiento" class="divFormulario">
            <div id="divPendienteRemplazo" class="divFormulario">
                <input id="inpDiagramaJsonCopia" name="diagramaJson" type="hidden" value="{{sesion.diagrama.diagramaJson}}">
                <input id="inpXNuevoObjeto" name="xNuevoObjeto" type="hidden">
                <input id="inpYNuevoObjeto" name="yNuevoObjeto" type="hidden">
                <script src="../javascripts/determinarObjeto.js"></script>
                <script src="../javascripts/determinarIdObjeto.js"></script>
                <script src="../javascripts/determinarNombreObjeto.js"></script>
                <script src="../javascripts/determinarNumeroPuerto.js"></script>
                <script src="../javascripts/editarDiagrama.js"></script>
            </div>
            <form id="formGrabarEdicionDiagramaSesion" method="POST" action="/main/grabarEdicionDiagramaSesion">
                <input id="inpDiagramaJson" name="diagramaJson" type="hidden" value="{{sesion.diagrama.diagramaJson}}">
                <input id="inpNombreUsuarioEdicion" name="nombreUsuarioEdicion" type="hidden" value="{{nombreUsuario}}">
                <input id="pIdSesionEdicion" name="idSesionEdicion" type="hidden" value="{{sesion.id}}">
                <input id="inpPasoCaptura" name="pasoCaptura" type="hidden" value="0">
                <input id="inpIndiceObjeto" name="indiceObjeto" type="hidden" value="">
                <input id="inpXInicioMovimiento" name="xInicioMovimiento" type="hidden">
                <input id="inpYInicioMovimiento" name="yInicioMovimiento" type="hidden">
                <div id="divEdicion" class="divSubformulario">
                    <b><label id="lblEdicionDiagrama" class="lblGuiaCaptura">Edición del diagrama</label></b><br><br>
                </div>
                <div id="divCoordenadasEdicion" class="divSubformulario">
                    <b><label class="lblCaptura">Coordenadas:</label></b>
                    <br>
                    <table class="tblEncabezado">
                        <tr>
                            <td>
                                <label class="lblCaptura" style="alignment: center">x</label>
                                <input id="inpXFinMovimiento" class="w3-input w3-round" name="xFinMovimiento" type="number" min="0" step="10">
                            </td>
                            <td>
                                <label class="lblCaptura" style="alignment: center">y</label>
                                <input id="inpYFinMovimiento" class="w3-input w3-round" name="yFinMovimiento" type="number" min="0" step="10">
                            </td>
                        </tr>
                    </table>
                    <br>
                </div>
                <div id="divGrabacionMovimiento" class="divSubformulario">
                    <label id="btnProbarMovimiento" type="submit" href="#" class="w3-button w3-round btnControl" onclick="probarDiagrama()" style="display: inline-block">Probar edición</label>
                    <button id="btnGrabarMovimiento" type="submit" class="w3-button w3-round btnControl" onclick="edicion()" style="display: inline-block">Grabar edición</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!--
Cargue de scripts de inicialización de la vista Diagrama
-->
<script src="../javascripts/funcionesVistaDiagrama.js"></script>
<script src="../javascripts/inicializacionVistaDiagrama.js"></script>
<script src="../javascripts/dibujarCuadricula.js"></script>
<script type="text/javascript">inicializacionVistaDiagrama("{{sesion.sesionJson}}","{{sesion.diagrama.diagramaJson}}");</script>
<script src="../javascripts/{{sesion.diagrama.tipoDiagrama.scriptDibujo}}"></script>
<script type="text/javascript">dibujarDiagrama("{{sesion.diagrama.diagramaJson}}","/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=");</script>
<script type="text/javascript">inicioFormularioCapturaObjeto();</script>
<script type="text/javascript">inicioFormularioCapturaRelacion();</script>

<!--
Inicialización sección de mensajería
-->
<script>
    let socket;
    $(document).ready(()=>{
        socket = io.connect(document.getElementById("urlServidor").innerHTML);
        socket.on("actualizacionDiagrama", (data)=>{
            console.log("Evento: "+data);
            document.getElementById("inpDiagramaJsonCopia").value = data.diagramaRecuperado;
            document.getElementById("inpDiagramaJson").value = data.diagramaRecuperado;
            dibujarDiagrama(data.diagramaRecuperado,"/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=");
        });
        socket.on("ubicacion", function (data) {
            ubicarUsuario(data.usuario,"{{nombreUsuario}}","{{sesion.nombreModerador}}",data.seccion);
            if (data.usuario != "{{nombreUsuario}}") {
                if (document.getElementById("banderaReserva").innerHTML != "") {
                    socket.emit("reservaAnterior", {msg:"{{nombreUsuario}} continúa preparando un elemento en el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
                }
                else {
                    socket.emit("respuestaUbicacion", {sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
                }
            }
        });
        socket.on("confirmacionUbicacion", function (data) {
            if (data.usuario != "{{nombreUsuario}}") {
                ubicarUsuario(data.usuario,"{{nombreUsuario}}","{{sesion.nombreModerador}}",data.seccion);
            }
        });
        socket.on("confirmacionAccion", function (data) {
            if (data.usuario != "{{nombreUsuario}}") {
                ubicarUsuario(data.usuario,"{{nombreUsuario}}","{{sesion.nombreModerador}}",data.seccion, true);
            }
        });
        socket.on("reunion", function (data) {
            if (data.usuario != "{{nombreUsuario}}") {
                alert(data.msg);
            }
        });
        socket.on("reserva", function (data) {
            if (data.usuario != "{{nombreUsuario}}") {
                if (document.getElementById("banderaReserva").innerHTML == "") {
                    document.getElementById("divFormularioObjeto").style.display = "none";
                    document.getElementById("divFormularioRelacion").style.display = "none";
                    document.getElementById("divFormularioMovimiento").style.display = "none";
                    ubicarUsuario(data.usuario,"{{nombreUsuario}}","{{sesion.nombreModerador}}",data.seccion,true);
                    document.getElementById("btnDesplegarOpcionesSesion").style.display = "none";
                } else {
                    socket.emit("reservaAnterior", {msg:"{{nombreUsuario}} continúa preparando un elemento en el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
                }
            } else {
                document.getElementById("banderaReserva").innerHTML="X";
                ubicarUsuario(data.usuario,"{{nombreUsuario}}","{{sesion.nombreModerador}}",data.seccion,true);
            }
        });
        socket.on("reservaAnterior", function (data) {
            if (data.usuario != "{{nombreUsuario}}") {
                document.getElementById("divFormularioObjeto").style.display = "none";
                document.getElementById("divFormularioRelacion").style.display = "none";
                document.getElementById("divFormularioMovimiento").style.display = "none";
                document.getElementById("btnDesplegarOpcionesSesion").style.display = "none";
                document.getElementById("banderaReserva").innerHTML = "";
                ubicarUsuario("{{nombreUsuario}}","{{nombreUsuario}}","{{sesion.nombreModerador}}","Diagrama");
                ubicarUsuario(data.usuario,"{{nombreUsuario}}","{{sesion.nombreModerador}}",data.seccion,true);
            }
        });
        socket.on("levantamientoReserva", function (data) {
            if (data.usuario != "{{nombreUsuario}}") {
                document.getElementById("btnDesplegarOpcionesSesion").style.display = "inline-block";
                document.getElementById("divFormularioObjeto").style.display = "none";
                document.getElementById("divFormularioRelacion").style.display = "none";
                document.getElementById("divFormularioMovimiento").style.display = "none";
                document.getElementById("banderaReserva").innerHTML="";
            }
            ubicarUsuario(data.usuario,"{{nombreUsuario}}","{{sesion.nombreModerador}}",data.seccion);
        });
        socket.on("connection", function (data) {
            console.log(data);
        });
        socket.emit("ingresoEquipo", {msg:"{{nombreUsuario}} ingresó al {{sesion.nombreTipoDiagrama}}", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
    });
    function alertaElemento(pTipoElemento){
        socket.emit("reserva", {msg:"{{nombreUsuario}} prepara un elemento en el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
    }
    function inclusionElemento(){
        clickOcultarOpciones();
        let i=0;
        while (document.getElementById("valorPropiedadObjeto"+i) != undefined) {
            document.getElementById("valorPropiedadObjeto"+i).value = removerCaracteresNoAceptados(document.getElementById("valorPropiedadObjeto"+i).value);
            i = i+1;
        }
        i=0;
        while (document.getElementById("valorPropiedadRelacion"+i) != undefined) {
            document.getElementById("valorPropiedadRelacion"+i).value = removerCaracteresNoAceptados(document.getElementById("valorPropiedadRelacion"+i).value);
            i = i+1;
        }
        document.getElementById("divBtnCapturaElemento").style.display = "inline-block";
        document.getElementById("btnDesplegarOpcionesSesion").style.display = "inline-block";
        document.getElementById("divFormularioObjeto").style.display = "none";
        document.getElementById("divFormularioRelacion").style.display = "none";
        document.getElementById("divFormularioMovimiento").style.display="none";
        socket.emit("levantamientoReserva", {msg:"{{nombreUsuario}} incluyó un elemento en el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
    }
    function desistimientoElemento(pTipoElemento){
        clickOcultarOpciones();
        document.getElementById("inpDiagramaJson").value = document.getElementById("inpDiagramaJsonCopia").value;
        dibujarDiagrama(document.getElementById("inpDiagramaJson").value, "/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=");
        socket.emit("levantamientoReserva", {msg:"{{nombreUsuario}} desistió de incluir un elemento en el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
        document.getElementById("banderaReserva").innerHTML="";
    }
    function alertaEdicion(){
        document.getElementById("divPresentacionDiagrama").style.width = Math.round(window.innerWidth * 0.75)+"px";
        document.getElementById("divCapturaElemento").style.width = Math.round(window.innerWidth * 0.25)+"px";
        document.getElementById("btnCapturaObjeto").style.display = "none";
        document.getElementById("btnCapturaRelacion").style.display = "none";

        document.getElementById("divFormularioObjeto").style.display = "none";
        document.getElementById("divFormularioRelacion").style.display = "none";
        document.getElementById("divFormularioMovimiento").style.display="block";
        socket.emit("reserva", {msg:"{{nombreUsuario}} está editando el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
    }
    function edicion(){
        document.getElementById("capturarMovimiento").style.display="none";
        socket.emit("levantamientoReserva", {msg:"{{nombreUsuario}} editó el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
    }
    function desistimientoEdicion(pTipoElemento){
        clickOcultarOpciones();
        document.getElementById("divBtnCapturaElemento").style.display = "inline-block";
        document.getElementById("divFormularioObjeto").style.display = "none";
        document.getElementById("divFormularioRelacion").style.display = "none";
        document.getElementById("divFormularioMovimiento").style.display="none";
        document.getElementById("inpDiagramaJson").value = document.getElementById("inpDiagramaJsonCopia").value;
        dibujarDiagrama(document.getElementById("inpDiagramaJson").value, "/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=");
        socket.emit("levantamientoReserva", {msg:"{{nombreUsuario}} desistió de editar el diagrama", sesion:"{{sesion.id}}", seccion:"Diagrama", usuario:"{{nombreUsuario}}"});
        document.getElementById("banderaReserva").innerHTML="";
    }
    function llamarReunion() {
        socket.emit("reunionEquipo", {msg:"{{nombreUsuario}} solicita reunirse en el {{sesion.nombreTipoDiagrama}}", sesion:"{{sesion.id}}", usuario:"{{nombreUsuario}}"});
    }
    function downObjetoSeleccionado(ev,pIndice,pId,pNombre) {
        document.getElementById("inpIndiceObjetoSeleccionado").value = pIndice;
        document.getElementById("inpIdObjetoSeleccionado").value = pId;
        document.getElementById("divPropiedadesObjeto").style.display = "inline-block";
    }
    function down(ev) {
        document.getElementById("inpXObjeto").value=Math.round((ev.clientX-document.getElementById("divPresentacionDiagrama").offsetLeft-document.getElementById("imgDiagrama").offsetLeft+document.getElementById("divPresentacionDiagrama").scrollLeft)/10)*10;
        document.getElementById("inpYObjeto").value=Math.round((ev.clientY-document.getElementById("divPresentacionDiagrama").offsetTop-document.getElementById("imgDiagrama").offsetTop+document.getElementById("divPresentacionDiagrama").scrollTop)/10)*10;
    }
    function downObjetoInicial(ev,pIndice,pId) {
        document.getElementById("inpIndiceObjetoInicial").value = pIndice;
        document.getElementById("inpIdObjetoInicial").value = pId;
        dibujarDiagrama(document.getElementById("inpDiagramaJson").value, "/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=",2);
        capturaRelacion(2,"","","");
    }
    function downPuertoInicial(ev,pNumero,pNombre) {
        document.getElementById("inpNombreObjetoInicial").value = pNombre;
        document.getElementById("inpNumeroPuertoObjetoInicial").value = pNumero;
        dibujarDiagrama(document.getElementById("inpDiagramaJson").value, "/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=",3);
        capturaRelacion(3,"","","");
    }
    function downObjetoFinal(ev,pIndice,pId,pNombre) {
        document.getElementById("inpIndiceObjetoFinal").value = pIndice;
        document.getElementById("inpIdObjetoFinal").value = pId;
        dibujarDiagrama(document.getElementById("inpDiagramaJson").value, "/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=",4);
        capturaRelacion(4,"","","");
    }
    function downPuertoFinal(ev,pNumero,pNombre) {
        document.getElementById("inpNombreObjetoFinal").value = pNombre;
        document.getElementById("inpNumeroPuertoObjetoFinal").value = pNumero;
        dibujarDiagrama(document.getElementById("inpDiagramaJson").value, "/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=",5);
        capturaRelacion(5,"","","");
    }
    function allowDrop(ev) {
        ev.preventDefault();
    }
    function drag(ev) {
        if (document.getElementById("btnDesplegarOpcionesSesion").style.display == "none") {
            ev.dataTransfer.setData("text", ev.target.id);
            document.getElementById("inpXInicioMovimiento").value=ev.clientX-document.getElementById("divPresentacionDiagrama").offsetLeft-document.getElementById("imgDiagrama").offsetLeft+document.getElementById("divPresentacionDiagrama").scrollLeft;
            document.getElementById("inpYInicioMovimiento").value=ev.clientY-document.getElementById("divPresentacionDiagrama").offsetTop-document.getElementById("imgDiagrama").offsetTop+document.getElementById("divPresentacionDiagrama").scrollTop;
        }
    }
    function drop(ev) {
        if (document.getElementById("btnDesplegarOpcionesSesion").style.display == "none") {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("text");
            document.getElementById("inpXFinMovimiento").value=Math.round((ev.clientX-document.getElementById("divPresentacionDiagrama").offsetLeft-document.getElementById("imgDiagrama").offsetLeft+document.getElementById("divPresentacionDiagrama").scrollLeft)/10)*10;
            document.getElementById("inpYFinMovimiento").value=Math.round((ev.clientY-document.getElementById("divPresentacionDiagrama").offsetTop-document.getElementById("imgDiagrama").offsetTop+document.getElementById("divPresentacionDiagrama").scrollTop)/10)*10;
            alertaEdicion();
            document.getElementById("inpIndiceObjeto").value = determinarObjeto(document.getElementById("inpDiagramaJson").value,document.getElementById("inpXInicioMovimiento").value,document.getElementById("inpYInicioMovimiento").value);
            dibujarDiagrama(editarDiagrama(document.getElementById("inpDiagramaJson").value,document.getElementById("inpXInicioMovimiento").value,document.getElementById("inpYInicioMovimiento").value,document.getElementById("inpXFinMovimiento").value,document.getElementById("inpYFinMovimiento").value,document.getElementById("inpIndiceObjeto").value),"/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=");
            clickEditarDiagrama();
        }
    }
    function probarDiagrama() {
        dibujarDiagrama(editarDiagrama(document.getElementById("inpDiagramaJson").value,document.getElementById("inpXInicioMovimiento").value,document.getElementById("inpYInicioMovimiento").value,document.getElementById("inpXFinMovimiento").value,document.getElementById("inpYFinMovimiento").value,document.getElementById("inpIndiceObjeto").value),"/main/presentarArgumentacionSesion?idSesion={{sesion.id}}&nombreUsuario={{nombreUsuario}}&perfilUsuario="+document.getElementById("perfilUsuario").innerHTML+"&idObjeto=");
    }
</script>
